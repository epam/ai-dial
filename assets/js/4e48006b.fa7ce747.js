"use strict";(self.webpackChunkdial=self.webpackChunkdial||[]).push([[5562],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var i=s(96540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},77182:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"tutorials/devops/auth-and-access-control/configure-idps/okta","title":"okta","description":"Table of Contents","source":"@site/docs/tutorials/2.devops/2.auth-and-access-control/2.configure-idps/okta.md","sourceDirName":"tutorials/2.devops/2.auth-and-access-control/2.configure-idps","slug":"/tutorials/devops/auth-and-access-control/configure-idps/okta","permalink":"/tutorials/devops/auth-and-access-control/configure-idps/okta","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"CustomSideBar","previous":{"title":"Keycloak","permalink":"/tutorials/devops/auth-and-access-control/configure-idps/keycloak"},"next":{"title":"Observability","permalink":"/tutorials/devops/observability-config"}}');var t=s(74848),r=s(28453);const o={},l="How to Set Okta as Identity Provider",c={},a=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Introduction",id:"introduction",level:2},{value:"Configuration Guidelines",id:"configuration-guidelines",level:2},{value:"Configure Okta",id:"configure-okta",level:3},{value:"Configure AI DIAL",id:"configure-ai-dial",level:3},{value:"AI DIAL Chat Settings",id:"ai-dial-chat-settings",level:4},{value:"AI DIAL Core Settings",id:"ai-dial-core-settings",level:4},{value:"Assignment of Roles",id:"assignment-of-roles",level:4}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"how-to-set-okta-as-identity-provider",children:"How to Set Okta as Identity Provider"})}),"\n",(0,t.jsxs)("div",{class:"docusaurus-ignore",children:[(0,t.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#introduction",children:"Introduction"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#configuration-guidelines",children:"Configuration Guidelines"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#configure-okta",children:"Configure Okta"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#configure-ai-dial",children:"Configure AI DIAL"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#ai-dial-chat-settings",children:"AI DIAL Chat Settings"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#ai-dial-core-settings",children:"AI DIAL Core Settings"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#assignment-of-roles",children:"Assignment of Roles"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]}),"\n",(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsxs)(n.p,{children:["This basic tutorial demonstrates how to configure an application in ",(0,t.jsx)(n.a,{href:"https://www.okta.com/customer-identity/single-sign-on",children:"Okta"})," and use it as an identity and access management solution for AI DIAL users."]}),"\n",(0,t.jsx)(n.p,{children:"In AI DIAL, you can assign roles to Models and Applications to restrict the number of tokens that can be transmitted in a specific time frame. These roles and their limitations can be created in external systems and then assigned in AI DIAL's configuration."}),"\n",(0,t.jsx)(n.h2,{id:"configuration-guidelines",children:"Configuration Guidelines"}),"\n",(0,t.jsx)(n.h3,{id:"configure-okta",children:"Configure Okta"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": Replace ",(0,t.jsx)(n.code,{children:"<chat_url>"})," with the actual address of your AI DIAL Chat application."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Follow these steps to configure Okta:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create an Application"}),": start with creating a new ",(0,t.jsx)(n.a,{href:"https://help.okta.com/oie/en-us/content/topics/apps/apps_app_integration_wizard_oidc.htm",children:"Application"}),".","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Sign-in method"}),": ",(0,t.jsx)(n.code,{children:"OIDC - OpenID Connect"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Application type"}),": ",(0,t.jsx)(n.code,{children:"Web Application"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"App integration name"}),": e.g., ",(0,t.jsx)(n.code,{children:"ai-dial-chat"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Sign-in redirect URIs"}),": ",(0,t.jsx)(n.code,{children:"<chat_url>/api/auth/callback/okta"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Sign-out redirect URIs"}),": ",(0,t.jsx)(n.code,{children:"<chat_url>"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Controlled access"}),": ",(0,t.jsx)(n.code,{children:"Skip group assignment for now"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Grant type/Core grants"}),": ",(0,t.jsx)(n.code,{children:"Authorization Code"}),", ",(0,t.jsx)(n.code,{children:"Refresh Token"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Enable API Scopes"}),": navigate to ",(0,t.jsx)(n.strong,{children:"Applications/Application name/Okta API Scopes"})," tab, enable the following scopes:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"okta.users.read"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"okta.users.read.self"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Setup Access Policy"}),": navigate to ",(0,t.jsx)(n.strong,{children:"Security/API/Authorization Servers/Authorization Server name/Access Policies"})," tab, and ensure there's a policy that allows your application to access the API, e.g.:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Add New Access Policy"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Policy name"}),": e.g., ",(0,t.jsx)(n.code,{children:"ai-dial-chat"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": e.g., ",(0,t.jsx)(n.code,{children:"Allow access to the API for ai-dial-chat application"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Assign to"}),": ",(0,t.jsx)(n.code,{children:"The following clients"})," + select your application"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Add rule"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Rule name"}),": e.g., ",(0,t.jsx)(n.code,{children:"Allow"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"IF Grant type is"}),": ",(0,t.jsx)(n.code,{children:"Client Credentials"}),", ",(0,t.jsx)(n.strong,{children:"Core grants"}),": ",(0,t.jsx)(n.code,{children:"Authorization Code"}),", ",(0,t.jsx)(n.strong,{children:"Other grants"}),": ",(0,t.jsx)(n.code,{children:"Implicit (Hybrid)"}),", ",(0,t.jsx)(n.code,{children:"Resource Owner Password"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"AND User is"}),": ",(0,t.jsx)(n.code,{children:"Any user assigned to the app"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"AND Scopes requested"}),": ",(0,t.jsx)(n.code,{children:"openid"}),", ",(0,t.jsx)(n.code,{children:"profile"}),", ",(0,t.jsx)(n.code,{children:"email"})]}),"\n",(0,t.jsx)(n.li,{children:"other settings can be left as default"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create Users"}),": once the application integration is set up, ",(0,t.jsx)(n.a,{href:"https://help.okta.com/oie/en-us/content/topics/sers-groups-profiles/usgp-people.htm",children:"create users"})," in ",(0,t.jsx)(n.strong,{children:"Directory/People"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Gather facts"}),": to proceed with DIAL configuration, collect information related to Okta:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["In top right corner, select your profile and save your ",(0,t.jsx)(n.strong,{children:"Okta domain"})," (",(0,t.jsx)(n.code,{children:"<okta_domain>"}),"), e.g. ",(0,t.jsx)(n.code,{children:"dev-123456.okta.com"})]}),"\n",(0,t.jsxs)(n.li,{children:["In ",(0,t.jsx)(n.strong,{children:"Security/API/Authorization Servers/Authorization Server name/"})," section, locate ",(0,t.jsx)(n.strong,{children:"Metadata URI"})," and open it. Save ",(0,t.jsx)(n.strong,{children:"issuer"})," (",(0,t.jsx)(n.code,{children:"<okta_issuer>"}),"), ",(0,t.jsx)(n.strong,{children:"jwks_uri"})," (",(0,t.jsx)(n.code,{children:"<okta_jwks_uri>"}),") values from JSON response."]}),"\n",(0,t.jsxs)(n.li,{children:["In ",(0,t.jsx)(n.strong,{children:"Applications/Application name/General"})," tab, save ",(0,t.jsx)(n.strong,{children:"Client ID"})," (",(0,t.jsx)(n.code,{children:"<okta_client_id>"}),") and ",(0,t.jsx)(n.strong,{children:"Client secret"})," (",(0,t.jsx)(n.code,{children:"<okta_client_secret>"}),")"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["(Optional, RBAC) ",(0,t.jsx)(n.strong,{children:"Create & Assign Groups"}),": the best way to sustainably manage user authentication is creating user groups and assigning applications to that groups.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["In ",(0,t.jsx)(n.strong,{children:"Directory/Groups"}),", ",(0,t.jsx)(n.a,{href:"https://help.okta.com/oie/en-us/content/topics/users-groups-profiles/usgp-groups-main.htm",children:"Add groups"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["In ",(0,t.jsx)(n.strong,{children:"Directory/Groups/Group name/People"})," tab, assign people to relevant groups."]}),"\n",(0,t.jsxs)(n.li,{children:["In ",(0,t.jsx)(n.strong,{children:"Directory/Groups/Group name/Applications"})," tab, ",(0,t.jsx)(n.a,{href:"https://help.okta.com/oie/en-us/content/topics/users-groups-profiles/usgp-assign-app-group.htm",children:"Assign applications"})," to relevant groups."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["(Optional, RBAC) ",(0,t.jsx)(n.a,{href:"https://developer.okta.com/docs/guides/customize-tokens-groups-claim/main",children:(0,t.jsx)(n.strong,{children:"Configure ID Token Groups Claim"})}),": navigate to ",(0,t.jsx)(n.strong,{children:"Applications/Sign On/OpenID Connect ID Token"})," section and edit:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Groups claim type"}),": ",(0,t.jsx)(n.code,{children:"Filter"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Groups claim filter"}),": ",(0,t.jsx)(n.code,{children:"groups"})," + ",(0,t.jsx)(n.code,{children:"Matches regex"})," + ",(0,t.jsx)(n.code,{children:".*"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"configure-ai-dial",children:"Configure AI DIAL"}),"\n",(0,t.jsx)(n.p,{children:"By configuring both AI DIAL Chat and AI DIAL Core with the necessary environment variables, you will enable them to work together seamlessly with Identity Provider for authentication and authorization purposes."}),"\n",(0,t.jsx)(n.h4,{id:"ai-dial-chat-settings",children:"AI DIAL Chat Settings"}),"\n",(0,t.jsxs)(n.p,{children:["Add the following environment variables to AI DIAL Chat ",(0,t.jsx)(n.a,{href:"https://github.com/epam/ai-dial-chat/blob/development/apps/chat/README.md#environment-variables",children:"configuration"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'AUTH_OKTA_ISSUER: "<okta_issuer>"\nAUTH_OKTA_CLIENT_ID: "<okta_client_id>"\nAUTH_OKTA_CLIENT_SECRET: "<okta_client_secret>"\n'})}),"\n",(0,t.jsx)(n.h4,{id:"ai-dial-core-settings",children:"AI DIAL Core Settings"}),"\n",(0,t.jsxs)(n.p,{children:["Add the following parameters to AI DIAL Core ",(0,t.jsxs)(n.a,{href:"https://github.com/epam/ai-dial-core?tab=readme-ov-file#static-settings",children:[(0,t.jsx)(n.strong,{children:"static"})," settings"]}),":"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": ",(0,t.jsx)(n.code,{children:"<okta_domain_regex>"})," is ",(0,t.jsx)(n.code,{children:"<okta_domain>"})," with dots escaped, e.g. ",(0,t.jsx)(n.code,{children:"dev-123456\\.okta\\.com"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": generate some random sting for ",(0,t.jsx)(n.code,{children:"loggingSalt"})," parameter, e.g. using ",(0,t.jsx)(n.code,{children:"pwgen -s 32 1"})]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'aidial.identityProviders.okta.jwksUrl: "<okta_jwks_uri>"\naidial.identityProviders.okta.issuerPattern: \'^https:\\/\\/<okta_domain_regex>.*$\'\naidial.identityProviders.okta.loggingKey: "sub"\naidial.identityProviders.okta.loggingSalt: "loggingSalt"\naidial.identityProviders.okta.rolePath: "Groups"\n'})}),"\n",(0,t.jsx)(n.h4,{id:"assignment-of-roles",children:"Assignment of Roles"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Warning"}),": RBAC-related steps from ",(0,t.jsx)(n.a,{href:"#configure-okta",children:"Configure Okta"})," must be completed before proceeding with this section."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"In AI DIAL Core:"}),"\n",(0,t.jsxs)(n.p,{children:["To limit access to AI DIAL resources based on Okta Groups, configure the AI DIAL Core by adjusting the ",(0,t.jsx)(n.a,{href:"https://github.com/epam/ai-dial-core?tab=readme-ov-file#dynamic-settings",children:"Dynamic settings"}),": set the ",(0,t.jsx)(n.code,{children:"userRoles"})," parameter to align with the desired Okta group names."]}),"\n",(0,t.jsxs)(n.p,{children:["In the provided example, users assigned the ",(0,t.jsx)(n.code,{children:"okta-group-name"})," group will have access to the ",(0,t.jsx)(n.code,{children:"chat-gpt-35-turbo"})," model."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "models": {\n    "gpt-35-turbo": {\n      "type": "chat",\n      "endpoint": "http://localhost:5000/v1/openai/deployments/gpt-35-turbo/chat/completions",\n      "upstreams": [\n        {\n          "endpoint": "https://[REDACTED].openai.azure.com/openai/deployments/gpt-35-turbo/chat/completions",\n          "key": "[REDACTED]"\n        }\n      ],\n      "userRoles": [\n        "okta-group-name"\n      ]\n    }\n  }\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);