"use strict";(self.webpackChunkdial=self.webpackChunkdial||[]).push([[1611],{8335:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var a=t(5893),i=t(1151);const r={},s="Create Custom Visualizer",o={id:"tutorials/developers/chat/create-custom-visualizer",title:"Create Custom Visualizer",description:"We call Visualizers special applications that are used for rendering a specific type of content in AI DIAL Chat UI. You can use DIAL Chat Visualizer Connector library to create your custom visualizers for specific types of content.",source:"@site/docs/tutorials/1.developers/3.chat/2.create-custom-visualizer.md",sourceDirName:"tutorials/1.developers/3.chat",slug:"/tutorials/developers/chat/create-custom-visualizer",permalink:"/tutorials/developers/chat/create-custom-visualizer",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"CustomSideBar",previous:{title:"AI DIAL Chat Localization",permalink:"/tutorials/developers/chat/localization"},next:{title:"AI DIAL Chat Design Structure Guidelines",permalink:"/tutorials/developers/chat/chat-design"}},l={},c=[{value:"AI DIAL Chat Configuration",id:"ai-dial-chat-configuration",level:3},{value:"Main Concepts",id:"main-concepts",level:3},{value:"Create Visualizer",id:"create-visualizer",level:3},{value:"Example",id:"example",level:3},{value:"Module.tsx",id:"moduletsx",level:4},{value:"index.ts",id:"indexts",level:4}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"create-custom-visualizer",children:"Create Custom Visualizer"}),"\n",(0,a.jsxs)(n.p,{children:["We call Visualizers special applications that are used for rendering a specific type of content in AI DIAL Chat UI. You can use ",(0,a.jsx)(n.a,{href:"https://github.com/epam/ai-dial-chat/blob/development/libs/chat-visualizer-connector/README.md",children:"DIAL Chat Visualizer Connector"})," library to create your custom visualizers for specific types of content."]}),"\n",(0,a.jsxs)(n.p,{children:["Watch a ",(0,a.jsx)(n.a,{href:"/video%20demos/Applications/dial-data-viz",children:"demo video"})," to view how a financial data can be visualized in AI DIAL Chat."]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["Sources are located in the ",(0,a.jsx)(n.a,{href:"https://github.com/epam/ai-dial-chat/blob/development/libs/chat-visualizer-connector/README.md",children:"DIAL Chat Visualizer Connector"})," repository."]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"ai-dial-chat-configuration",children:"AI DIAL Chat Configuration"}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["Refer to ",(0,a.jsx)(n.a,{href:"https://github.com/epam/ai-dial-chat/blob/development/apps/chat/README.md",children:"Configuration"})," to view all parameters and their description."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Configure AI DIAL Chat to enable visualizers:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"ALLOWED_IFRAME_SOURCES"})," - a list of allowed iframe sources in ",(0,a.jsx)(n.code,{children:"<source> <source>"})," format. For security reasons, your AI DIAL Chat application should configure the sources where your custom visualizers will be hosted. ",(0,a.jsx)(n.strong,{children:"Note"}),": For development purposes, you can set ",(0,a.jsx)(n.code,{children:"*"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"ALLOWED_IFRAME_SOURCES=http://localhost:8000\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"CUSTOM_VISUALIZERS"})," - a list of the objects with custom visualizers properties. This properties are : ",(0,a.jsx)(n.code,{children:"{ title, description, icon, contentType, url }"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface CustomVisualizer {\ntitle: string;\ndescription: string;\nicon: string;\ncontentType: string;\nurl: string;\n}\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'//AI DIAL Chat configuration example\nCUSTOM_VISUALIZERS=[\n                    {\n                    "title":"CUSTOM_VISUALIZER", // Visualizer title\n                    "description": "CUSTOM VISUALIZER to render images", // Short description for the Visualizer\n                    "icon":"data:image/svg+xml;base64,some-base64-image", // Icon for the Visualizer\n                    "contentType":"image/png,image/jpg", // List of MIME types that Visualizer could render separated by ","\n                    "url":"http://localhost:8000" // Visualizer host\n                    },\n                    {\n                    //Other Visualizer\n                    }\n\n                ]\n\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"ALLOW_VISUALIZER_SEND_MESSAGES"})," - is a flag that allows or disables the addition of custom buttons or input fields. This enables a custom visualizer to send ",(0,a.jsx)(n.code,{children:"SEND_MESSAGE"})," events on behalf of a user in the form of messages within a conversation."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"main-concepts",children:"Main Concepts"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"ChatVisualizerConnector"})," class provides all the necessary methods for a visualizer (rendered in the iframe) to interact with AI DIAL Chat (receive data to visualize)."]}),"\n",(0,a.jsxs)(n.p,{children:["A model or application should send data in ",(0,a.jsx)(n.strong,{children:"Json"}),"-like format which should include a ",(0,a.jsx)(n.code,{children:"CustomVisualizerDataLayout"})," object with ",(0,a.jsx)(n.code,{children:"width"})," and ",(0,a.jsx)(n.code,{children:"height"})," properties. All other properties could be set to anything you need for your visualizer:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"export interface CustomVisualizerDataLayout {\n  width: number;\n  height: number;\n}\n\nexport interface CustomVisualizerData {\n  layout: CustomVisualizerDataLayout;\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"create-visualizer",children:"Create Visualizer"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Install the ",(0,a.jsx)(n.code,{children:"ai-dial-chat-visualizer-connector"})," library:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm i @epam/ai-dial-chat-visualizer-connector\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Add a file to the serving folder in your application, or simply import it in the code:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import { AttachmentData, ChatVisualizerConnector, CustomVisualizerDataLayout } from '@epam/ai-dial-chat-visualizer-connector';\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"ChatVisualizerConnector"})," - this class provides methods for the visualizer (rendered in the iframe) to interact with AI DIAL Chat (receive data to visualize). It requires the following arguments:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"/**\n * Params for a ChatVisualizerConnector\n* @param dialHost {string} DIAL CHAT host\n* @param appName {string} name of the Visualizer same as in config\n* @param dataCallback {(visualizerData: AttachmentData) => void} callback to get data that will be used in the Visualizer\n*/\n\n//instance example\nnew ChatVisualizerConnector(dialHost, appName, setData);\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"AttachmentData"})," - an interface for the payload you will get from AI DIAL Chat:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"export interface AttachmentData {\nmimeType: string;\nvisualizerData: CustomVisualizerData;\n}\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"CustomVisualizerDataLayout"})," - an interface for the layout you will get from AI DIAL Chat. ",(0,a.jsx)(n.code,{children:"width"})," and ",(0,a.jsx)(n.code,{children:"height"})," properties are required for a proper rendering in the AI DIAL Chat UI:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"export interface CustomVisualizerDataLayout {\nwidth: number;\nheight: number;\n}\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Set ",(0,a.jsx)(n.code,{children:"dialHost"})," to the AI DIAL Chat host you want to connect with:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const dialHost = 'https://hosted-dial-chat-domain.com';\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Set ",(0,a.jsx)(n.code,{children:"appName"})," to match the value of ",(0,a.jsx)(n.code,{children:"title"})," in the AI DIAL Chat configuration in the ",(0,a.jsx)(n.code,{children:"CUSTOM_VISUALIZERS"})," environmental variable:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const appName = 'CUSTOM_VISUALIZER';\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Create an instance of ",(0,a.jsx)(n.code,{children:"ChatVisualizerConnector"})," in your code:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"//Here you store your data which you get from the DIAL CHAT\nconst [data, setData] = useState<AttachmentData>();\n\nconst chatVisualizerConnector = useRef<ChatVisualizerConnector | null>(null);\n\nuseEffect(() => {\nif (!chatVisualizerConnector.current && dialHost && appName) {\n    chatVisualizerConnector.current = new ChatVisualizerConnector(dialHost, appName, setData);\n\n    return () => {\n    chatVisualizerConnector.current?.destroy();\n    chatVisualizerConnector.current = null;\n    };\n}\n}, [appName, dialHost]);\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Send a ",(0,a.jsx)(n.code,{children:"READY"})," event via ",(0,a.jsx)(n.code,{children:"sendReady()"})," to AI DIAL Chat to inform that your visualizer is ready (this action will hide the loader). Then, you could do some preparation (login, etc.) and, after that, send ",(0,a.jsx)(n.code,{children:"READY TO INTERACT"})," event via ",(0,a.jsx)(n.code,{children:"sendReadyToInteract()"})," to inform AI DIAL Chat that the visualizer is ready to receive data:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"useEffect(() => {\nif (appName && dialHost) {\n    chatVisualizerConnector.current?.sendReady();\n    //Make some actions if needed\n    chatVisualizerConnector.current?.sendReadyToInteract();\n}\n}, [dialHost, appName]);\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Make needed type assertion for the data from AI DIAL Chat. ",(0,a.jsx)(n.strong,{children:"Note"}),": Data send by model/application from DIAL CHAT should be the same type as you expect."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"//layout should include width and height properties\ninterface YourVisualizerLayout extends CustomVisualizerDataLayout {\n//any other layout properties expected from the model/application output\n}\ndata.visualizerData as { dataToRender: string; layout: YourVisualizerLayout };\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Render data in your visualizer:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"<div>{typedVisualizerData.dataToRender}</div>\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,a.jsx)(n.h4,{id:"moduletsx",children:"Module.tsx"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"\nimport { AttachmentData, ChatVisualizerConnector, CustomVisualizerDataLayout } from '@epam/ai-dial-chat-visualizer-connector';\n\n\nexport const Module: FC = () => {\n  const [data, setData] = useState<AttachmentData>();\n\n  const chatVisualizerConnector = useRef<ChatVisualizerConnector | null>(\n    null\n  );\n\n  //DIAL CHAT host\n  const dialHost = 'https://hosted-dial-chat-domain.com';\n\n  //Visualizer title. Should be same as in the DIAL CHAT configuration in CUSTOM_VISUALIZERS\n  const appName = 'CUSTOM_VISUALIZER';\n\n  useEffect(() => {\n    if (!chatVisualizerConnector.current && dialHost && appName) {\n      chatVisualizerConnector.current = new ChatVisualizerConnector(\n        dialHost,\n        appName,\n        setData\n      );\n\n      return () => {\n        chatVisualizerConnector.current?.destroy();\n        chatVisualizerConnector.current = null;\n      };\n    }\n  }, [appName, dialHost]);\n\n  useEffect(() => {\n    if (appName && dialHost) {\n      chatVisualizerConnector.current?.sendReady();\n      chatVisualizerConnector.current?.sendReadyToInteract();\n    }\n  }, [dialHost, appName]);\n\n  const typedVisualizerData = useMemo(() => {\n    return (\n      data?.visualizerData && (data.visualizerData as unknown as { dataToRender: string; layout: YourVisualizerLayout })\n    );\n  }, [data?.visualizerData]);\n\n  return (\n    <div>\n      {!!typedVisualizerData?.dataToRender && (\n          <div>\n            {typedVisualizerData.dataToRender}\n          </div>\n      )}\n    </div>\n  );\n};\n\n"})}),"\n",(0,a.jsx)(n.h4,{id:"indexts",children:"index.ts"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'//...other imports\nimport { Module } from "./Module.tsx";\n\nconst root = createRoot(document.getElementById("root"));\nroot.render(<Module />);\n\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>s});var a=t(7294);const i={},r=a.createContext(i);function s(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);